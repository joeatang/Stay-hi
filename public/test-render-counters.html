<!DOCTYPE html>
<html>
<head>
    <title>üîß Tesla Render Counters Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #000; color: #00ff00; }
        .result { padding: 10px; margin: 10px 0; border-left: 3px solid #00ff00; }
        .error { border-left-color: #ff0000; color: #ff0000; }
        button { background: #333; color: #00ff00; border: 1px solid #00ff00; padding: 10px; margin: 5px; cursor: pointer; }
        button:hover { background: #555; }
    </style>
</head>
<body>
    <h1>üîß Tesla Render Counters Test</h1>
    <p>Testing if renderCounters is available from the main dashboard page</p>
    
    <button onclick="testAvailability()">Test Function Availability</button>
    <button onclick="testExecution()">Test Function Execution</button>
    <button onclick="openMainDashboard()">Open Main Dashboard</button>
    
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function log(message, isError = false) {
            const div = document.createElement('div');
            div.className = `result ${isError ? 'error' : ''}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
        }
        
        function testAvailability() {
            log('üîç Testing renderCounters availability...');
            
            try {
                // Test if function exists on window
                log(`typeof window.renderCounters: ${typeof window.renderCounters}`);
                
                if (typeof window.renderCounters === 'function') {
                    log('‚úÖ renderCounters function is available!');
                } else {
                    log('‚ùå renderCounters function is NOT available', true);
                }
                
                // Test if parent window has it (if this is in iframe)
                if (window.parent && window.parent !== window) {
                    log(`Parent window renderCounters: ${typeof window.parent.renderCounters}`);
                }
                
            } catch (error) {
                log(`‚ùå Error testing availability: ${error.message}`, true);
            }
        }
        
        async function testExecution() {
            log('üöÄ Testing renderCounters execution...');
            
            try {
                if (typeof window.renderCounters === 'function') {
                    const result = await window.renderCounters();
                    log(`‚úÖ renderCounters executed successfully! Result: ${result}`);
                } else {
                    log('‚ùå Cannot execute - function not available', true);
                }
            } catch (error) {
                log(`‚ùå Execution error: ${error.message}`, true);
            }
        }
        
        function openMainDashboard() {
            window.open('http://localhost:8205/82815_stayhi_index.html', '_blank');
        }
        
        // Auto-test on load
        setTimeout(testAvailability, 1000);
    </script>
</body>
</html>