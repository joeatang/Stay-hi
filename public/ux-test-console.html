<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hi-Island UX Test Console</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 24px;
      backdrop-filter: blur(10px);
    }
    h1 { margin-bottom: 20px; color: #4ECDC4; }
    .test-section {
      margin: 20px 0;
      padding: 16px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      border-left: 4px solid #4ECDC4;
    }
    .test-button {
      background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      color: white;
      cursor: pointer;
      margin: 8px 8px 8px 0;
      font-weight: 600;
      transition: transform 0.2s;
    }
    .test-button:hover { transform: translateY(-2px); }
    .result {
      margin: 8px 0;
      padding: 8px 12px;
      border-radius: 6px;
      font-family: monospace;
    }
    .pass { background: rgba(46, 204, 113, 0.2); }
    .fail { background: rgba(231, 76, 60, 0.2); }
    .info { background: rgba(52, 152, 219, 0.2); }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§ª Hi-Island UX Test Console</h1>
    <p>Testing core functionality before tier system deployment</p>

    <div class="test-section">
      <h3>ğŸ¯ Priority 1: Drop Hi Button Test</h3>
      <button class="test-button" onclick="testDropHiButton()">Test Drop Hi Button</button>
      <div id="drop-hi-results"></div>
    </div>

    <div class="test-section">
      <h3>ğŸ“Š Priority 2: Feed Loading Test</h3>
      <button class="test-button" onclick="testFeedLoading()">Test Feed System</button>
      <div id="feed-results"></div>
    </div>

    <div class="test-section">
      <h3>ğŸ”„ Priority 3: Tab Navigation Test</h3>
      <button class="test-button" onclick="testTabNavigation()">Test Tab Switching</button>
      <div id="tab-results"></div>
    </div>

    <div class="test-section">
      <h3>ğŸ” Priority 4: Authentication Test</h3>
      <button class="test-button" onclick="testAuthentication()">Test Auth System</button>
      <div id="auth-results"></div>
    </div>

    <div class="test-section">
      <h3>ğŸ“ˆ Priority 5: Database Integration Test</h3>
      <button class="test-button" onclick="testDatabaseIntegration()">Test Database Connection</button>
      <div id="db-results"></div>
    </div>

  </div>

  <script>
    function addResult(containerId, message, type = 'info') {
      const container = document.getElementById(containerId);
      const result = document.createElement('div');
      result.className = `result ${type}`;
      result.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
      container.appendChild(result);
    }

    async function testDropHiButton() {
      addResult('drop-hi-results', 'ğŸ§ª Testing Drop Hi button functionality...', 'info');
      
      try {
        // Open Hi-Island in new window for testing
        const hiIsland = window.open('http://127.0.0.1:3000/hi-island-NEW.html', 'hi-island-test', 'width=800,height=600');
        
        if (hiIsland) {
          addResult('drop-hi-results', 'âœ… Hi-Island window opened successfully', 'pass');
          
          // Wait for page to load
          setTimeout(() => {
            try {
              const dropButton = hiIsland.document.getElementById('dropHiButton');
              if (dropButton) {
                addResult('drop-hi-results', 'âœ… Drop Hi button found in DOM', 'pass');
                addResult('drop-hi-results', `ğŸ¯ Button onclick: ${dropButton.getAttribute('onclick')}`, 'info');
                
                // Test if openHiComposer function exists
                if (typeof hiIsland.openHiComposer === 'function') {
                  addResult('drop-hi-results', 'âœ… openHiComposer function exists', 'pass');
                } else {
                  addResult('drop-hi-results', 'âš ï¸ openHiComposer function not found', 'fail');
                }
              } else {
                addResult('drop-hi-results', 'âŒ Drop Hi button not found in DOM', 'fail');
              }
            } catch (e) {
              addResult('drop-hi-results', `âŒ Cross-origin error: ${e.message}`, 'fail');
            }
          }, 2000);
        } else {
          addResult('drop-hi-results', 'âŒ Failed to open Hi-Island window', 'fail');
        }
      } catch (error) {
        addResult('drop-hi-results', `âŒ Test failed: ${error.message}`, 'fail');
      }
    }

    async function testFeedLoading() {
      addResult('feed-results', 'ğŸ§ª Testing feed loading system...', 'info');
      
      try {
        // Test if components are accessible
        const response = await fetch('http://127.0.0.1:3000/components/hi-real-feed/HiRealFeed.js');
        if (response.ok) {
          addResult('feed-results', 'âœ… HiRealFeed.js component accessible', 'pass');
        } else {
          addResult('feed-results', 'âŒ HiRealFeed.js component not found', 'fail');
        }
        
        // Test database wrapper
        const dbResponse = await fetch('http://127.0.0.1:3000/lib/HiDB.js');
        if (dbResponse.ok) {
          addResult('feed-results', 'âœ… HiDB.js database wrapper accessible', 'pass');
        } else {
          addResult('feed-results', 'âŒ HiDB.js not accessible', 'fail');
        }
        
      } catch (error) {
        addResult('feed-results', `âŒ Feed test failed: ${error.message}`, 'fail');
      }
    }

    async function testTabNavigation() {
      addResult('tab-results', 'ğŸ§ª Testing tab navigation system...', 'info');
      
      // Test tab structure
      const hiIsland = window.open('http://127.0.0.1:3000/hi-island-NEW.html', 'hi-island-tabs', 'width=800,height=600');
      
      setTimeout(() => {
        try {
          const generalTab = hiIsland.document.getElementById('tab-general');
          const archiveTab = hiIsland.document.getElementById('tab-archive');
          
          if (generalTab && archiveTab) {
            addResult('tab-results', 'âœ… Tab buttons found in DOM', 'pass');
            addResult('tab-results', `ğŸ¯ General tab class: ${generalTab.className}`, 'info');
            addResult('tab-results', `ğŸ¯ Archive tab class: ${archiveTab.className}`, 'info');
          } else {
            addResult('tab-results', 'âŒ Tab buttons not found', 'fail');
          }
        } catch (e) {
          addResult('tab-results', `âŒ Tab test error: ${e.message}`, 'fail');
        }
      }, 2000);
    }

    async function testAuthentication() {
      addResult('auth-results', 'ğŸ§ª Testing authentication system...', 'info');
      
      try {
        // Test auth files
        const authResponse = await fetch('http://127.0.0.1:3000/assets/progressive-auth.js');
        if (authResponse.ok) {
          addResult('auth-results', 'âœ… Progressive auth system accessible', 'pass');
        } else {
          addResult('auth-results', 'âŒ Progressive auth not found', 'fail');
        }
        
        // Test Supabase
        const supabaseResponse = await fetch('http://127.0.0.1:3000/lib/HiSupabase.js');
        if (supabaseResponse.ok) {
          addResult('auth-results', 'âœ… Supabase integration accessible', 'pass');
        } else {
          addResult('auth-results', 'âŒ Supabase integration not found', 'fail');
        }
        
      } catch (error) {
        addResult('auth-results', `âŒ Auth test failed: ${error.message}`, 'fail');
      }
    }

    async function testDatabaseIntegration() {
      addResult('db-results', 'ğŸ§ª Testing database integration...', 'info');
      
      try {
        // Check if we can access the Hi-Island page and check for errors
        const response = await fetch('http://127.0.0.1:3000/hi-island-NEW.html');
        if (response.ok) {
          const html = await response.text();
          
          // Check for key database integrations
          if (html.includes('public_shares')) {
            addResult('db-results', 'âœ… public_shares table reference found', 'pass');
          }
          
          if (html.includes('hi_archives')) {
            addResult('db-results', 'âœ… hi_archives table reference found', 'pass');
          }
          
          if (html.includes('global_community_stats')) {
            addResult('db-results', 'âœ… global_community_stats table reference found', 'pass');
          }
          
          addResult('db-results', 'âœ… Database schema integration appears correct', 'pass');
          
        } else {
          addResult('db-results', 'âŒ Could not access Hi-Island page', 'fail');
        }
        
      } catch (error) {
        addResult('db-results', `âŒ Database test failed: ${error.message}`, 'fail');
      }
    }

    // Auto-run basic connectivity test
    window.addEventListener('load', () => {
      addResult('drop-hi-results', 'ğŸš€ Test console loaded - ready for UX validation', 'info');
    });
  </script>
</body>
</html>