<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stay Hi — Home</title>
  <style>
    :root{
      --brand-bg1:#F5A623; --brand-bg2:#FFC107;
      --hi-green:#006400; --ink:#0b0b0b; --paper:#FFFDF9;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;margin:0;background:linear-gradient(135deg,var(--brand-bg1),var(--brand-bg2));color:#111}
    .wrap{max-width:960px;margin:0 auto;padding:24px}
    .card{background:#fff;border:1px solid #eee;border-radius:16px;padding:20px;box-shadow:0 8px 18px rgba(0,0,0,.05)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    a.btn,button.btn{display:inline-block;background:var(--hi-green);color:#fff;text-decoration:none;padding:12px 18px;border-radius:12px;font-weight:700;border:0;cursor:pointer}
    .ghost{background:#fff;color:#111;border:1px solid #ddd}
    .note{color:#333;font-size:14px;margin-top:12px}
    /* header */
    header.slim{position:sticky;top:0;backdrop-filter:saturate(1.2) blur(6px);-webkit-backdrop-filter:saturate(1.2) blur(6px);
      background:rgba(255,255,255,.85);border-bottom:1px solid rgba(0,0,0,.06);z-index:10}
    .bar{height:56px;max-width:960px;margin:0 auto;padding:0 12px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:8px;margin:0 auto}
    .brand img{width:20px;height:20px}
    details.menu{position:relative}
    details.menu>summary{list-style:none;width:40px;height:40px;display:grid;place-items:center;border-radius:999px;border:1px solid #e5e5e5;background:#fff;cursor:pointer;font-size:22px}
    details.menu[open] > div{display:block}
    details.menu>div{display:none;position:absolute;right:0;top:48px;width:220px;background:#fff;border:1px solid #e5e5e5;border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.08);overflow:hidden}
    .menu a,.menu button{display:block;width:100%;text-align:left;padding:10px 14px;font-size:14px;color:#111;text-decoration:none;background:#fff;border:0}
    .menu a:hover,.menu button:hover{background:#f6f6f6}
  </style>
</head>
<body>
  <header class="slim" data-authless="false">
    <div class="bar">
      <div style="width:40px"></div>
      <a class="brand" href="index.html">
        <img src="https://ucarecdn.com/4233fafa-2eee-45bf-bee2-eb6578070c5b/-/format/auto/" alt="Stay Hi" />
        <strong>Stay Hi</strong>
      </a>
      <details class="menu" id="menu">
        <summary aria-label="Menu">⋯</summary>
        <div>
          <a href="index.html">Home</a>
          <a href="hi-island.html">Hi Island</a>
          <a id="menuProfile" href="profile.html">Profile</a>
          <a id="menuSignin" href="signin.html">Sign in</a>
          <button id="menuLogout" type="button" style="display:none">Logout</button>
        </div>
      </details>
    </div>
  </header>

  <div class="wrap" style="padding-top:20px">
    <div class="card" style="text-align:center">
      <img src="https://ucarecdn.com/4233fafa-2eee-45bf-bee2-eb6578070c5b/-/format/auto/" alt="Stay Hi" style="width:84px;height:auto;margin-bottom:10px"/>
      <h1 style="margin:8px 0 4px">Welcome to Stay Hi!</h1>
      <p style="margin:0 0 16px;color:#333">Join our community of positive vibes.</p>
      <div class="row" style="justify-content:center">
        <a class="btn" id="ctaSignin" href="signin.html">Sign in</a>
        <a class="btn ghost" id="ctaJoin" href="signup.html">Join now</a>
        <a class="btn ghost" id="ctaProfile" href="profile.html" style="display:none">My profile</a>
      </div>
      <div class="note" id="who">Checking your session…</div>
    </div>
  </div>

<script>
(async function initHeader(){
  const isAuthPage = false; // home shows menu
  const m = await fetch('/api/auth',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'me'})}).then(r=>r.json()).catch(()=>({}));
  const signed = !!m?.user;
  // Toggle header items
  document.getElementById('menuSignin').style.display = signed ? 'none':'block';
  document.getElementById('menuLogout').style.display = signed ? 'block':'none';
  // Home CTAs
  const who = document.getElementById('who');
  if (signed) {
    who.textContent = `Signed in as ${m.user.email}`;
    document.getElementById('ctaProfile').style.display='inline-block';
  } else {
    who.textContent = 'You are not signed in.';
  }
  document.getElementById('menuLogout').onclick = async ()=>{
    await fetch('/api/auth',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'logout'})});
    location.href='index.html';
  };
})();
</script>
</body>
</html>
